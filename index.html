<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Executor JSON Web com CSS estruturado</title>
</head>
<body>
  <div id="app"></div>

  <script>
    function aplicarEventos(el, eventos) {
      for (let evento in eventos) {
        el.addEventListener(evento, function (e) {
          try {
            eval(eventos[evento]);
          } catch (err) {
            console.error("Erro no evento:", err);
          }
        });
      }
    }

    function criarElemento(e) {
      let el = document.createElement(e.tag || "div");

      if (e.attrs) {
        for (let k in e.attrs) {
          if (k === "innerHTML") {
            el.innerHTML = e.attrs[k];
          } else {
            el.setAttribute(k, e.attrs[k]);
          }
        }
      }

      if (e.text) el.textContent = e.text;

      if (e.style) {
        for (let prop in e.style) {
          el.style[prop] = e.style[prop];
        }
      }

      if (e.events) {
        aplicarEventos(el, e.events);
      }

      if (e.children) {
        e.children.forEach(child => {
          el.appendChild(criarElemento(child));
        });
      }

      return el;
    }

    // Aplica CSS baseado em JSON estruturado
    function aplicarCssJson(cssJson) {
      const styleTag = document.createElement("style");
      let cssText = "";

      for (let seletor in cssJson) {
        cssText += seletor + " {";
        const props = cssJson[seletor];
        for (let prop in props) {
          const cssProp = prop.replace(/([A-Z])/g, "-$1").toLowerCase(); // camelCase -> kebab-case
          cssText += `${cssProp}:${props[prop]};`;
        }
        cssText += "} ";
      }

      styleTag.textContent = cssText;
      document.head.appendChild(styleTag);
    }

    fetch("https://dev-victor-yt.github.io/Executor-Web.Json/index.json")
      .then(res => res.json())
      .then(json => {
        if (json.css) aplicarCssJson(json.css);
        if (json.html) {
          const root = criarElemento(json.html);
          document.getElementById("app").appendChild(root);
        }
      })
      .catch(err => {
        document.getElementById("app").textContent = "Erro ao carregar JSON: " + err;
      });
  </script>
</body>
</html>