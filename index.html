<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Executor Web JSON</title>
</head>
<body>
<div id="app">Carregando layout...</div>

<script>
  // Função para aplicar eventos
  function aplicarEventos(el, eventos) {
    for (let tipo in eventos) {
      try {
        el.addEventListener(tipo, function(e) {
          try {
            eval(eventos[tipo]);
          } catch (err) {
            console.error("Erro no evento:", err);
          }
        });
      } catch (err) {
        console.error("Erro ao adicionar evento:", err);
      }
    }
  }

  // Função para criar elementos HTML a partir de JSON
  function criarElemento(json) {
    try {
      let el = document.createElement(json.tag || "div");

      // Atributos padrão
      if (json.attrs) {
        for (let k in json.attrs) {
          if (k === "innerHTML") {
            el.innerHTML = json.attrs[k];
          } else {
            el.setAttribute(k, json.attrs[k]);
          }
        }
      }

      // Texto
      if (json.text) {
        el.textContent = json.text;
      }

      // Estilos inline
      if (json.style) {
        for (let s in json.style) {
          el.style[s] = json.style[s];
        }
      }

      // Eventos
      if (json.events) {
        aplicarEventos(el, json.events);
      }

      // Elementos filhos
      if (json.children && Array.isArray(json.children)) {
        json.children.forEach(child => {
          let filho = criarElemento(child);
          if (filho) el.appendChild(filho);
        });
      }

      return el;
    } catch (e) {
      console.error("Erro ao criar elemento:", e);
      return null;
    }
  }

  // Função para aplicar CSS global via <style>
  function aplicarCSSGlobal(cssText) {
    try {
      const style = document.createElement("style");
      style.innerHTML = cssText;
      document.head.appendChild(style);
    } catch (e) {
      console.error("Erro ao aplicar CSS:", e);
    }
  }

  // Carregamento do JSON externo
  fetch("https://dev-victor-yt.github.io/Executor-Web.Json/index.json")
    .then(res => res.json())
    .then(json => {
      document.getElementById("app").innerHTML = "";
      if (json.css) aplicarCSSGlobal(json.css);
      const raiz = criarElemento(json.html || json);
      if (raiz) {
        document.getElementById("app").appendChild(raiz);
      } else {
        document.getElementById("app").textContent = "Erro ao montar layout.";
      }
    })
    .catch(err => {
      console.error("Erro ao carregar JSON:", err);
      document.getElementById("app").textContent = "Erro no carregamento: " + err.message;
    });
</script>
</body>
</html>